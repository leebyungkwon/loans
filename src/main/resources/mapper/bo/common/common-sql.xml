<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loanscrefia.common.common.repository.CommonRepository">
	<insert id="insertFile" parameterType="com.loanscrefia.common.common.domain.FileDomain" useGeneratedKeys="true" keyProperty="fileSeq">
		<!-- CommonRepository.insertFile -->
		insert into tb_lc_file01
		(
			file_ext, file_org_nm, file_path, file_save_nm, reg_timestamp, upd_timestamp, use_yn, file_type
		)
		values(
			#{fileExt}, #{fileOrgNm}, #{filePath}, #{fileSaveNm}, now(), now(), 'Y'
			<choose>
				<when test="fileType != null and fileType != ''">
					,#{fileType}
				</when>
				<otherwise>
					,'0'
				</otherwise>
			</choose>
		)
	</insert>
	
	
	
	<!-- 공통코드조회 selectBox -->
	<select id="selectCommonCodeList" parameterType="codeDtl" resultType="codeDtl">
		SELECT
			 CODE_MST_CD
			,CODE_DTL_CD
			,CODE_DTL_NM
			,CODE_DTL_DESC
			,PROPERTY01
			,PROPERTY02
			,PROPERTY03
			,PROPERTY04
			,PROPERTY05
			,REG_DATE
			,REG_NO
		FROM tbl_code_dtl
		WHERE
			CODE_MST_CD = #{codeMstCd}
		<if test="property01 != null and property01 != ''">
			AND PROPERTY01 = #{property01}
		</if>
		<if test="property02 != null and property02 != ''">
			AND PROPERTY02 = #{property02}
		</if>
		<if test="property03 != null and property03 != ''">
			AND PROPERTY03 = #{property03}
		</if>
		<if test="property04 != null and property04 != ''">
			AND PROPERTY04 = #{property04}
		</if>
		<if test="property05 != null and property05 != ''">
			AND PROPERTY05 = #{property05}
		</if>
	</select>
	
	
	
	<!-- 공통코드조회 selectBox -->
	<select id="selectCompanyCodeList" parameterType="codeDtl" resultType="codeDtl">
		SELECT
			 COM_CODE		AS CODE_DTL_CD
			,COM_NAME		AS CODE_DTL_NM
		FROM TB_LC_COMPANY
	</select>
	
	
	<!-- 첨부파일 그룹ID 조회 -->
	<select id="selectFileGroupId" resultType="int">
		SELECT NEXTVAL('tb_lc_grp_file01_seq');
	</select>
	
	<!-- 첨부파일 단건 조회 -->
	<select id="getFile" parameterType="file" resultType="file">
		select
			file_seq
			, file_grp_seq
			, file_type
			, file_ext
			, file_org_nm
			, file_path
			, file_save_nm
			, reg_timestamp
			, upd_timestamp
			, use_yn
		from tb_lc_file01
		where file_seq = #{fileSeq}
	</select>
	
</mapper> 