<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loanscrefia.common.common.repository.CommonRepository">

	<!-- 첨부파일 리스트 -->
	<select id="selectFileList" parameterType="file" resultType="file">
		SELECT
			 FILE_SEQ
			,FILE_GRP_SEQ
			,FILE_TYPE
			,FILE_EXT
			,FILE_ORG_NM
			,FILE_PATH
			,FILE_SAVE_NM
			,CONCAT(FILE_ORG_NM,'.',FILE_EXT) AS FILE_FULL_NM
			,USE_YN
		FROM TB_LC_FILE01
		<where>
			AND FILE_GRP_SEQ 	= #{fileGrpSeq}
			AND USE_YN 			= 'Y'
		</where>
	</select>

	<!-- 첨부파일 그룹 시퀀스 조회 -->
	<select id="selectFileGrpSeq" resultType="int" parameterType="file">
		SELECT NEXTVAL('tb_lc_grp_file01_seq')
	</select>

	<!-- 첨부파일 등록 -->
	<insert id="insertFile" parameterType="file" useGeneratedKeys="true" keyProperty="fileSeq">
		INSERT INTO TB_LC_FILE01
		(
			 FILE_GRP_SEQ
			,FILE_TYPE
			,FILE_EXT
			,FILE_ORG_NM
			,FILE_PATH
			,FILE_SAVE_NM
			,USE_YN
			,REG_TIMESTAMP
		)
		VALUES
		(
			<choose>
				<when test="fileGrpSeq != null and fileGrpSeq != ''">
					#{fileGrpSeq}
				</when>
				<otherwise>
					0
				</otherwise>
			</choose>
			<choose>
				<when test="fileType != null and fileType != ''">
					,#{fileType}
				</when>
				<otherwise>
					,'0'
				</otherwise>
			</choose>
			,#{fileExt}
			,#{fileOrgNm}
			,#{filePath}
			,#{fileSaveNm}
			,'Y'
			,now()
		)
	</insert>
	
	<!-- 첨부파일 단건 조회 -->
	<select id="getFile" parameterType="file" resultType="file">
		SELECT
			 FILE_SEQ
			,FILE_GRP_SEQ
			,FILE_TYPE
			,FILE_EXT
			,FILE_ORG_NM
			,FILE_PATH
			,FILE_SAVE_NM
			,CONCAT(FILE_ORG_NM,'.',FILE_EXT) AS FILE_FULL_NM
			,REG_TIMESTAMP
			,UPD_TIMESTAMP
			,USE_YN
		FROM TB_LC_FILE01
		WHERE FILE_SEQ 	= #{fileSeq}
		AND USE_YN 		= 'Y'
	</select>
	
	<!-- 첨부파일 삭제 -->
	<update id="deleteFile" parameterType="file">
   		UPDATE TB_LC_FILE01
   		SET
   			 USE_YN = 'N'
   		<where>
   			AND FILE_SEQ = #{fileSeq}
   		</where>
   	</update>
	
	<!-- 회원사 리스트 -->
	<select id="selectCompanyCodeList" parameterType="codeDtl" resultType="codeDtl">
		SELECT
			 COM_CODE		AS CODE_DTL_CD
			,COM_NAME		AS CODE_DTL_NM
		FROM TB_LC_COMPANY
		WHERE COM_CODE != 1
	</select>
	
	
	
	
	
</mapper> 