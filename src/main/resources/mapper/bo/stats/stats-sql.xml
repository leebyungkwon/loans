<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loanscrefia.admin.stats.repository.StatsRepository">

	<!-- 회사별 모집인 -->
	<select id="selectStatsResult1" parameterType="stats" resultType="stats">
		SELECT 
			 COALESCE(A.COM_CODE_NM,'합계') AS COM_CODE_NM
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE1
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
		FROM (
			SELECT 
				 Z.*
				,Z.CASE1 + Z.CASE5 AS TOTAL1
				,Z.CASE2 + Z.CASE6 AS TOTAL2
				,Z.CASE3 + Z.CASE7 AS TOTAL3
				,Z.CASE4 + Z.CASE8 AS TOTAL4
			FROM (
				SELECT 
					 FN_COM_CODE(COM_CODE) AS COM_CODE_NM
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' THEN 1 ELSE 0 END) CASE1
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' THEN 1 ELSE 0 END) CASE2
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE3
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE4
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' THEN 1 ELSE 0 END) CASE5
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' THEN 1 ELSE 0 END) CASE6
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE7
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE8
				FROM TB_LC_MAS01
				<where>
					AND USE_YN = 'Y'
					<choose>
						<when test='plRegStat != null and plRegStat != ""'>
							<choose>
								<when test='plRegStat.equals("1")'>
									AND PL_REG_STAT = '1'
									AND PL_STAT IN ('2','5')
								</when>
								<when test='plRegStat.equals("2")'>
									AND PL_REG_STAT = '2'
									AND PL_STAT = '9'
								</when>
								<otherwise>
									AND PL_REG_STAT IN ('3','5')
								</otherwise>
							</choose>
						</when>
						<otherwise>
							AND (
								(PL_REG_STAT = '1' AND PL_STAT IN ('2','5'))
								OR
								(PL_REG_STAT = '2' AND PL_STAT = '9')
								OR
								(PL_REG_STAT IN ('3','5'))
							)
						</otherwise>
					</choose>
				</where>
				GROUP BY COM_CODE
				HAVING COM_CODE IS NOT NULL
			)Z
		)A
		GROUP BY ROLLUP(A.COM_CODE_NM)
		ORDER BY A.COM_CODE_NM ASC
	</select>
	
	<!-- 경력신규 -->
	<select id="selectStatsResult2" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(B.CAREER_TYP_NM,'합계') AS CAREER_TYP_NM
			,SUM(B.CASE1) AS CASE1
			,SUM(B.CASE2) AS CASE1
			,SUM(B.CASE3) AS CASE3
			,SUM(B.CASE4) AS CASE4
			,SUM(B.CASE5) AS CASE5
			,SUM(B.CASE6) AS CASE6
			,SUM(B.CASE7) AS CASE7
			,SUM(B.CASE8) AS CASE8
			,SUM(B.CASE9) AS CASE9
			,SUM(B.CASE10) AS CASE10
			,SUM(B.CASE11) AS CASE11
			,SUM(B.CASE12) AS CASE12
			,SUM(B.TOTAL1) AS TOTAL1
			,SUM(B.TOTAL2) AS TOTAL2
			,SUM(B.TOTAL3) AS TOTAL3
			,SUM(B.TOTAL4) AS TOTAL4
			,SUM(B.TOTAL5) AS TOTAL5
			,SUM(B.TOTAL6) AS TOTAL6
		FROM (
			SELECT 
				 A.*
				,A.CASE1 + A.CASE3 AS TOTAL1
				,A.CASE2 + A.CASE4 AS TOTAL2
				,A.CASE5 + A.CASE7 AS TOTAL3
				,A.CASE6 + A.CASE8 AS TOTAL4
				,A.CASE9 + A.CASE11 AS TOTAL5
				,A.CASE10 + A.CASE12 AS TOTAL6
			FROM (
				SELECT 
					 FN_CD_DTL('CAR001',CAREER_TYP) AS CAREER_TYP_NM
					,SUM(CASE WHEN PL_PRODUCT = '01' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '1' AND PL_STAT IN ('2','5') THEN 1 ELSE 0 END) CASE1
					,SUM(CASE WHEN PL_PRODUCT = '01' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '1' AND PL_STAT IN ('2','5') THEN 1 ELSE 0 END) CASE2
					,SUM(CASE WHEN PL_PRODUCT = '05' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '1' AND PL_STAT IN ('2','5') THEN 1 ELSE 0 END) CASE3
					,SUM(CASE WHEN PL_PRODUCT = '05' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '1' AND PL_STAT IN ('2','5') THEN 1 ELSE 0 END) CASE4
					,SUM(CASE WHEN PL_PRODUCT = '01' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '2' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE5
					,SUM(CASE WHEN PL_PRODUCT = '01' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '2' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE6
					,SUM(CASE WHEN PL_PRODUCT = '05' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '2' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE7
					,SUM(CASE WHEN PL_PRODUCT = '05' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '2' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE8
					,SUM(CASE WHEN PL_PRODUCT = '01' AND CORP_USER_YN = 'N' AND PL_REG_STAT IN ('3','5') THEN 1 ELSE 0 END) CASE9
					,SUM(CASE WHEN PL_PRODUCT = '01' AND CORP_USER_YN = 'Y' AND PL_REG_STAT IN ('3','5') THEN 1 ELSE 0 END) CASE10
					,SUM(CASE WHEN PL_PRODUCT = '05' AND CORP_USER_YN = 'N' AND PL_REG_STAT IN ('3','5') THEN 1 ELSE 0 END) CASE11
					,SUM(CASE WHEN PL_PRODUCT = '05' AND CORP_USER_YN = 'Y' AND PL_REG_STAT IN ('3','5') THEN 1 ELSE 0 END) CASE12
				FROM TB_LC_MAS01 TLM 
				WHERE USE_YN = 'Y'
				AND PL_CLASS = '1'
				GROUP BY CAREER_TYP, CI
			)A
		)B
		GROUP BY ROLLUP(B.CAREER_TYP_NM)
		ORDER BY B.CAREER_TYP_NM ASC
	</select>
	
	<!-- 경력 현황 -->
	<select id="selectStatsResult3" parameterType="stats" resultType="stats">
		SELECT 
			 Z.*
			,Z.CASE1 + Z.CASE5 AS TOTAL1
			,Z.CASE2 + Z.CASE6 AS TOTAL2
			,Z.CASE3 + Z.CASE7 AS TOTAL3
			,Z.CASE4 + Z.CASE8 AS TOTAL4
		FROM (
			SELECT 
				 COALESCE(FN_CD_DTL('CAR002',A.CODE_DTL_CD),'합계') AS CODE_DTL_NM
				,COALESCE(SUM(B.CASE1),0) AS CASE1
				,COALESCE(SUM(B.CASE2),0) AS CASE2
				,COALESCE(SUM(B.CASE3),0) AS CASE3
				,COALESCE(SUM(B.CASE4),0) AS CASE4
				,COALESCE(SUM(B.CASE5),0) AS CASE5
				,COALESCE(SUM(B.CASE6),0) AS CASE6
				,COALESCE(SUM(B.CASE7),0) AS CASE7
				,COALESCE(SUM(B.CASE8),0) AS CASE8
			FROM TB_LC_COD01_DETAIL A 
			LEFT OUTER JOIN (
				SELECT
					 TRUNC(((TO_CHAR(NOW(),'YYYYMMDD')::DATE - MIN(CRE_LICENSE_DATE)::DATE) + 1) / 365) AS CRE_LICENSE_DATE
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' THEN 1 ELSE 0 END) CASE1
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' THEN 1 ELSE 0 END) CASE2
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE3
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE4
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' THEN 1 ELSE 0 END) CASE5
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' THEN 1 ELSE 0 END) CASE6
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE7
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' THEN 1 ELSE 0 END) CASE8
				FROM TB_LC_MAS01
				WHERE USE_YN = 'Y'
				AND PL_REG_STAT = '3'
				AND CRE_LICENSE_DATE IS NOT NULL 
				AND CRE_LICENSE_DATE != ''
				GROUP BY PL_CLASS, CASE WHEN PL_CLASS = '1' THEN CI ELSE PL_MERCHANT_NO END
			)B
			ON A.CODE_DTL_CD::INTEGER = B.CRE_LICENSE_DATE
			WHERE A.CODE_MST_CD = 'CAR002'
			GROUP BY ROLLUP(A.CODE_DTL_CD)
			ORDER BY A.CODE_DTL_CD::INTEGER ASC
		)Z
	</select>
	
	<!-- 부적격처리건수(모집인별) -->
	<select id="selectStatsResult4" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(A.NAME,'합계') AS NAME
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE2
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
		FROM (
			SELECT
				 Z.*
				,Z.CASE1 + Z.CASE5 AS TOTAL1
				,Z.CASE2 + Z.CASE6 AS TOTAL2
				,Z.CASE3 + Z.CASE7 AS TOTAL3
				,Z.CASE4 + Z.CASE8 AS TOTAL4
			FROM (
				SELECT 
					 NAME
					,COALESCE(CASE1,0) AS CASE1
					,COALESCE(CASE2,0) AS CASE2
					,COALESCE(CASE3,0) AS CASE3
					,COALESCE(CASE4,0) AS CASE4
					,COALESCE(CASE5,0) AS CASE5
					,COALESCE(CASE6,0) AS CASE6
					,COALESCE(CASE7,0) AS CASE7
					,COALESCE(CASE8,0) AS CASE8
				FROM TB_LC_INAQ_STATS
			)Z
		)A
		GROUP BY ROLLUP(A.NAME)
		ORDER BY A.NAME ASC
	</select>
	
	<!-- 부적격버튼 클릭 시 통계 데이터 insert or update -->
	<insert id="saveInaqInfoForStats" parameterType="stats">
		WITH UPSERT AS(
			UPDATE TB_LC_INAQ_STATS
			SET
				<choose>
					<when test='plProduct.equals("01") and plClass.equals("1") and corpUserYn.equals("N")'>
						CASE1 = CASE1 + 1
					</when>
					<when test='plProduct.equals("01") and plClass.equals("1") and corpUserYn.equals("Y")'>
						CASE2 = CASE2 + 1
					</when>
					<when test='plProduct.equals("01") and plClass.equals("2")'>
						CASE3 = CASE3 + 1
					</when>
					<when test='plProduct.equals("03") and plClass.equals("2")'>
						CASE4 = CASE4 + 1
					</when>
					<when test='plProduct.equals("05") and plClass.equals("1") and corpUserYn.equals("N")'>
						CASE5 = CASE5 + 1
					</when>
					<when test='plProduct.equals("05") and plClass.equals("1") and corpUserYn.equals("Y")'>
						CASE6 = CASE6 + 1
					</when>
					<when test='plProduct.equals("05") and plClass.equals("2")'>
						CASE7 = CASE7 + 1
					</when>
					<when test='plProduct.equals("06") and plClass.equals("2")'>
						CASE8 = CASE8 + 1
					</when>
				</choose>  
			WHERE U_KEY = #{uKey}
			RETURNING *
		)
		INSERT INTO TB_LC_INAQ_STATS
		(
			 NAME
			,U_KEY
			<choose>
				<when test='plProduct.equals("01") and plClass.equals("1") and corpUserYn.equals("N")'>
					,CASE1
				</when>
				<when test='plProduct.equals("01") and plClass.equals("1") and corpUserYn.equals("Y")'>
					,CASE2
				</when>
				<when test='plProduct.equals("01") and plClass.equals("2")'>
					,CASE3
				</when>
				<when test='plProduct.equals("03") and plClass.equals("2")'>
					,CASE4
				</when>
				<when test='plProduct.equals("05") and plClass.equals("1") and corpUserYn.equals("N")'>
					,CASE5
				</when>
				<when test='plProduct.equals("05") and plClass.equals("1") and corpUserYn.equals("Y")'>
					,CASE6
				</when>
				<when test='plProduct.equals("05") and plClass.equals("2")'>
					,CASE7
				</when>
				<when test='plProduct.equals("06") and plClass.equals("2")'>
					,CASE8
				</when>
			</choose>  
		)
		SELECT 
			<choose>
				<when test='plClass.equals("1")'>
					#{name}
				</when>
				<otherwise>
					FN_CORP_NAME(#{uKey})
				</otherwise>
			</choose>
			,#{uKey}
			<choose>
				<when test='plProduct.equals("01") and plClass.equals("1") and corpUserYn.equals("N")'>
					,1
				</when>
				<when test='plProduct.equals("01") and plClass.equals("1") and corpUserYn.equals("Y")'>
					,1
				</when>
				<when test='plProduct.equals("01") and plClass.equals("2")'>
					,1
				</when>
				<when test='plProduct.equals("03") and plClass.equals("2")'>
					,1
				</when>
				<when test='plProduct.equals("05") and plClass.equals("1") and corpUserYn.equals("N")'>
					,1
				</when>
				<when test='plProduct.equals("05") and plClass.equals("1") and corpUserYn.equals("Y")'>
					,1
				</when>
				<when test='plProduct.equals("05") and plClass.equals("2")'>
					,1
				</when>
				<when test='plProduct.equals("06") and plClass.equals("2")'>
					,1
				</when>
			</choose>  
		WHERE NOT EXISTS (SELECT * FROM UPSERT)
	</insert>
	
	<!-- 등록처리현황(회사별) -->
	<select id="selectStatsResult5" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(A.COM_CODE_NM,'합계') AS COM_CODE_NM
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE2
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.CASE9) AS CASE9
			,SUM(A.CASE10) AS CASE10
			,SUM(A.CASE11) AS CASE11
			,SUM(A.CASE12) AS CASE12
			,SUM(A.CASE13) AS CASE13
			,SUM(A.CASE14) AS CASE14
			,SUM(A.CASE15) AS CASE15
			,SUM(A.CASE16) AS CASE16
			,SUM(A.CASE17) AS CASE17
			,SUM(A.CASE18) AS CASE18
			,SUM(A.CASE19) AS CASE19
			,SUM(A.CASE20) AS CASE20
			,SUM(A.CASE21) AS CASE21
			,SUM(A.CASE22) AS CASE22
			,SUM(A.CASE23) AS CASE23
			,SUM(A.CASE24) AS CASE24
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
			,SUM(A.TOTAL5) AS TOTAL5
			,SUM(A.TOTAL6) AS TOTAL6
			,SUM(A.TOTAL7) AS TOTAL7
			,SUM(A.TOTAL8) AS TOTAL8
			,SUM(A.TOTAL9) AS TOTAL9
			,SUM(A.TOTAL10) AS TOTAL10
			,SUM(A.TOTAL11) AS TOTAL11
			,SUM(A.TOTAL12) AS TOTAL12
		FROM (
			SELECT
				 Z.*
				,Z.CASE1 + Z.CASE5 AS TOTAL1
				,Z.CASE2 + Z.CASE6 AS TOTAL2
				,Z.CASE3 + Z.CASE7 AS TOTAL3
				,Z.CASE4 + Z.CASE8 AS TOTAL4
				,Z.CASE9 + Z.CASE13 AS TOTAL5
				,Z.CASE10 + Z.CASE14 AS TOTAL6
				,Z.CASE11 + Z.CASE15 AS TOTAL7
				,Z.CASE12 + Z.CASE16 AS TOTAL8
				,Z.CASE17 + Z.CASE21 AS TOTAL9
				,Z.CASE18 + Z.CASE22 AS TOTAL10
				,Z.CASE19 + Z.CASE23 AS TOTAL11
				,Z.CASE20 + Z.CASE24 AS TOTAL12
			FROM (
				SELECT 
					 COM_CODE
					,FN_COM_CODE(COM_CODE) AS COM_CODE_NM
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE1
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE2
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE3
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE4
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE5
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE6
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE7
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT = '2' THEN 1 ELSE 0 END) CASE8
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE9
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE10
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE11
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE12
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE13
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE14
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE15
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND PL_REG_STAT = '1' AND PL_STAT IN ('5','15','13') THEN 1 ELSE 0 END) CASE16
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE17
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE18
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE19
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE20
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE21
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE22
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE23
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND ((PL_REG_STAT = '2' AND PL_STAT = '9') OR (PL_REG_STAT IN ('3','5'))) THEN 1 ELSE 0 END) CASE24
				FROM TB_LC_MAS01
				WHERE USE_YN = 'Y'
				AND COM_CODE IS NOT NULL
				<if test="srchDate1 != null and srchDate1 != ''">
					AND (CASE
							WHEN CRE_LICENSE_DATE = '' THEN NULL
							WHEN CRE_LICENSE_DATE IS NULL THEN NULL
							ELSE TO_DATE(CRE_LICENSE_DATE,'YYYYMMDD')
						END)::TIMESTAMP <![CDATA[>=]]> #{srchDate1}::TIMESTAMP
				</if>
				<if test="srchDate2 != null and srchDate2 != ''">
					AND (CASE
							WHEN CRE_LICENSE_DATE = '' THEN NULL
							WHEN CRE_LICENSE_DATE IS NULL THEN NULL
							ELSE TO_DATE(CRE_LICENSE_DATE,'YYYYMMDD')
						END)::TIMESTAMP <![CDATA[<]]> #{srchDate2}::TIMESTAMP + INTERVAL '1 day'
				</if>
				GROUP BY COM_CODE
			)Z
		)A
		GROUP BY ROLLUP(A.COM_CODE_NM)
		ORDER BY A.COM_CODE_NM ASC
	</select>
	
	<!-- 등록처리현황(모집인별) -->
	<select id="selectStatsResult6" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(A.NAME,'합계') AS NAME
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE2
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.CASE9) AS CASE9
			,SUM(A.CASE10) AS CASE10
			,SUM(A.CASE11) AS CASE11
			,SUM(A.CASE12) AS CASE12
			,SUM(A.CASE13) AS CASE13
			,SUM(A.CASE14) AS CASE14
			,SUM(A.CASE15) AS CASE15
			,SUM(A.CASE16) AS CASE16
			,SUM(A.CASE17) AS CASE17
			,SUM(A.CASE18) AS CASE18
			,SUM(A.CASE19) AS CASE19
			,SUM(A.CASE20) AS CASE20
			,SUM(A.CASE21) AS CASE21
			,SUM(A.CASE22) AS CASE22
			,SUM(A.CASE23) AS CASE23
			,SUM(A.CASE24) AS CASE24
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
			,SUM(A.TOTAL5) AS TOTAL5
			,SUM(A.TOTAL6) AS TOTAL6
			,SUM(A.TOTAL7) AS TOTAL7
			,SUM(A.TOTAL8) AS TOTAL8
			,SUM(A.TOTAL9) AS TOTAL9
			,SUM(A.TOTAL10) AS TOTAL10
			,SUM(A.TOTAL11) AS TOTAL11
			,SUM(A.TOTAL12) AS TOTAL12
		FROM (
			SELECT 
				 *
				,CASE1 + CASE5 AS TOTAL1
				,CASE2 + CASE6 AS TOTAL2
				,CASE3 + CASE7 AS TOTAL3
				,CASE4 + CASE8 AS TOTAL4
				,CASE9 + CASE13 AS TOTAL5
				,CASE10 + CASE14 AS TOTAL6
				,CASE11 + CASE15 AS TOTAL7
				,CASE12 + CASE16 AS TOTAL8
				,CASE17 + CASE21 AS TOTAL9
				,CASE18 + CASE22 AS TOTAL10
				,CASE19 + CASE23 AS TOTAL11
				,CASE20 + CASE24 AS TOTAL12
			FROM TB_LC_REG_STATS
		)A
		GROUP BY ROLLUP(A.NAME)
		ORDER BY A.NAME ASC
	</select>
	
	<!-- 해지처리현황(회사별) -->
	<select id="selectStatsResult7" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(A.COM_CODE_NM,'합계') AS COM_CODE_NM
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE2
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.CASE9) AS CASE9
			,SUM(A.CASE10) AS CASE10
			,SUM(A.CASE11) AS CASE11
			,SUM(A.CASE12) AS CASE12
			,SUM(A.CASE13) AS CASE13
			,SUM(A.CASE14) AS CASE14
			,SUM(A.CASE15) AS CASE15
			,SUM(A.CASE16) AS CASE16
			,SUM(A.CASE17) AS CASE17
			,SUM(A.CASE18) AS CASE18
			,SUM(A.CASE19) AS CASE19
			,SUM(A.CASE20) AS CASE20
			,SUM(A.CASE21) AS CASE21
			,SUM(A.CASE22) AS CASE22
			,SUM(A.CASE23) AS CASE23
			,SUM(A.CASE24) AS CASE24
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
			,SUM(A.TOTAL5) AS TOTAL5
			,SUM(A.TOTAL6) AS TOTAL6
			,SUM(A.TOTAL7) AS TOTAL7
			,SUM(A.TOTAL8) AS TOTAL8
			,SUM(A.TOTAL9) AS TOTAL9
			,SUM(A.TOTAL10) AS TOTAL10
			,SUM(A.TOTAL11) AS TOTAL11
			,SUM(A.TOTAL12) AS TOTAL12
		FROM (
			SELECT 
				Z.*
				,Z.CASE1 + Z.CASE5 AS TOTAL1
				,Z.CASE2 + Z.CASE6 AS TOTAL2
				,Z.CASE3 + Z.CASE7 AS TOTAL3
				,Z.CASE4 + Z.CASE8 AS TOTAL4
				,Z.CASE9 + Z.CASE13 AS TOTAL5
				,Z.CASE10 + Z.CASE14 AS TOTAL6
				,Z.CASE11 + Z.CASE15 AS TOTAL7
				,Z.CASE12 + Z.CASE16 AS TOTAL8
				,Z.CASE17 + Z.CASE21 AS TOTAL9
				,Z.CASE18 + Z.CASE22 AS TOTAL10
				,Z.CASE19 + Z.CASE23 AS TOTAL11
				,Z.CASE20 + Z.CASE24 AS TOTAL12
			FROM (
				SELECT 
					 COM_CODE
					,FN_COM_CODE(COM_CODE) AS COM_CODE_NM
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE1
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE2
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE3
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE4
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE5
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE6
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE7
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND ((PL_REG_STAT = '3' AND PL_STAT = '4') OR (PL_REG_STAT = '4' AND PL_STAT = '9')) THEN 1 ELSE 0 END) CASE8
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE9
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE10
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE11
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE12
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE13
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE14
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE15
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND PL_REG_STAT = '3' AND PL_STAT = '4' THEN 1 ELSE 0 END) CASE16
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE17
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE18
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE19
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE20
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE21
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE22
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE23
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND PL_REG_STAT = '4' AND PL_STAT = '9' THEN 1 ELSE 0 END) CASE24
				FROM TB_LC_MAS01
				WHERE USE_YN = 'Y'
				AND COM_CODE IS NOT NULL
				GROUP BY COM_CODE
				ORDER BY COM_CODE_NM ASC
			)Z
		)A
		GROUP BY ROLLUP(A.COM_CODE_NM)
		ORDER BY A.COM_CODE_NM ASC
	</select>
	
	<!-- 해지처리현황(모집인별) -->
	<select id="selectStatsResult8" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(A.NAME,'합계') AS NAME
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE2
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.CASE9) AS CASE9
			,SUM(A.CASE10) AS CASE10
			,SUM(A.CASE11) AS CASE11
			,SUM(A.CASE12) AS CASE12
			,SUM(A.CASE13) AS CASE13
			,SUM(A.CASE14) AS CASE14
			,SUM(A.CASE15) AS CASE15
			,SUM(A.CASE16) AS CASE16
			,SUM(A.CASE17) AS CASE17
			,SUM(A.CASE18) AS CASE18
			,SUM(A.CASE19) AS CASE19
			,SUM(A.CASE20) AS CASE20
			,SUM(A.CASE21) AS CASE21
			,SUM(A.CASE22) AS CASE22
			,SUM(A.CASE23) AS CASE23
			,SUM(A.CASE24) AS CASE24
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
			,SUM(A.TOTAL5) AS TOTAL5
			,SUM(A.TOTAL6) AS TOTAL6
			,SUM(A.TOTAL7) AS TOTAL7
			,SUM(A.TOTAL8) AS TOTAL8
			,SUM(A.TOTAL9) AS TOTAL9
			,SUM(A.TOTAL10) AS TOTAL10
			,SUM(A.TOTAL11) AS TOTAL11
			,SUM(A.TOTAL12) AS TOTAL12
		FROM (
			SELECT 
				 *
				,CASE1 + CASE5 AS TOTAL1
				,CASE2 + CASE6 AS TOTAL2
				,CASE3 + CASE7 AS TOTAL3
				,CASE4 + CASE8 AS TOTAL4
				,CASE9 + CASE13 AS TOTAL5
				,CASE10 + CASE14 AS TOTAL6
				,CASE11 + CASE15 AS TOTAL7
				,CASE12 + CASE16 AS TOTAL8
				,CASE17 + CASE21 AS TOTAL9
				,CASE18 + CASE22 AS TOTAL10
				,CASE19 + CASE23 AS TOTAL11
				,CASE20 + CASE24 AS TOTAL12
			FROM TB_LC_CANCEL_STATS
		)A
		GROUP BY ROLLUP(A.NAME)
		ORDER BY A.NAME ASC
	</select>
	
	<!-- 불법모집 이력현황 -->
	<select id="selectStatsResult9" parameterType="stats" resultType="stats">
		SELECT
			 COALESCE(A.COM_CODE_NM,'합계') AS COM_CODE_NM
			,SUM(A.CASE1) AS CASE1
			,SUM(A.CASE2) AS CASE2
			,SUM(A.CASE3) AS CASE3
			,SUM(A.CASE4) AS CASE4
			,SUM(A.CASE5) AS CASE5
			,SUM(A.CASE6) AS CASE6
			,SUM(A.CASE7) AS CASE7
			,SUM(A.CASE8) AS CASE8
			,SUM(A.CASE9) AS CASE9
			,SUM(A.CASE10) AS CASE10
			,SUM(A.CASE11) AS CASE11
			,SUM(A.CASE12) AS CASE12
			,SUM(A.CASE13) AS CASE13
			,SUM(A.CASE14) AS CASE14
			,SUM(A.CASE15) AS CASE15
			,SUM(A.CASE16) AS CASE16
			,SUM(A.CASE17) AS CASE17
			,SUM(A.CASE18) AS CASE18
			,SUM(A.CASE19) AS CASE19
			,SUM(A.CASE20) AS CASE20
			,SUM(A.CASE21) AS CASE21
			,SUM(A.CASE22) AS CASE22
			,SUM(A.CASE23) AS CASE23
			,SUM(A.CASE24) AS CASE24
			,SUM(A.CASE25) AS CASE25
			,SUM(A.CASE26) AS CASE26
			,SUM(A.CASE27) AS CASE27
			,SUM(A.CASE28) AS CASE28
			,SUM(A.CASE29) AS CASE29
			,SUM(A.CASE30) AS CASE30
			,SUM(A.CASE31) AS CASE31
			,SUM(A.CASE32) AS CASE32
			,SUM(A.CASE33) AS CASE33
			,SUM(A.CASE34) AS CASE34
			,SUM(A.CASE35) AS CASE35
			,SUM(A.CASE36) AS CASE36
			,SUM(A.CASE37) AS CASE37
			,SUM(A.CASE38) AS CASE38
			,SUM(A.CASE39) AS CASE39
			,SUM(A.CASE40) AS CASE40
			,SUM(A.CASE41) AS CASE41
			,SUM(A.CASE42) AS CASE42
			,SUM(A.CASE43) AS CASE43
			,SUM(A.CASE44) AS CASE44
			,SUM(A.CASE45) AS CASE45
			,SUM(A.CASE46) AS CASE46
			,SUM(A.CASE47) AS CASE47
			,SUM(A.CASE48) AS CASE48
			,SUM(A.CASE49) AS CASE49
			,SUM(A.CASE50) AS CASE50
			,SUM(A.CASE51) AS CASE51
			,SUM(A.CASE52) AS CASE52
			,SUM(A.CASE53) AS CASE53
			,SUM(A.CASE54) AS CASE54
			,SUM(A.CASE55) AS CASE55
			,SUM(A.CASE56) AS CASE56
			,SUM(A.CASE57) AS CASE57
			,SUM(A.CASE58) AS CASE58
			,SUM(A.CASE59) AS CASE59
			,SUM(A.CASE60) AS CASE60
			,SUM(A.CASE61) AS CASE61
			,SUM(A.CASE62) AS CASE62
			,SUM(A.CASE63) AS CASE63
			,SUM(A.CASE64) AS CASE64
			,SUM(A.CASE65) AS CASE65
			,SUM(A.CASE66) AS CASE66
			,SUM(A.CASE67) AS CASE67
			,SUM(A.CASE68) AS CASE68
			,SUM(A.CASE69) AS CASE69
			,SUM(A.CASE70) AS CASE70
			,SUM(A.CASE71) AS CASE71
			,SUM(A.CASE72) AS CASE72
			,SUM(A.CASE73) AS CASE73
			,SUM(A.CASE74) AS CASE74
			,SUM(A.CASE75) AS CASE75
			,SUM(A.CASE76) AS CASE76
			,SUM(A.CASE77) AS CASE77
			,SUM(A.CASE78) AS CASE78
			,SUM(A.CASE79) AS CASE79
			,SUM(A.CASE80) AS CASE80
			,SUM(A.CASE81) AS CASE81
			,SUM(A.CASE82) AS CASE82
			,SUM(A.CASE83) AS CASE83
			,SUM(A.CASE84) AS CASE84
			,SUM(A.CASE85) AS CASE85
			,SUM(A.CASE86) AS CASE86
			,SUM(A.CASE87) AS CASE87
			,SUM(A.CASE88) AS CASE88
			,SUM(A.TOTAL1) AS TOTAL1
			,SUM(A.TOTAL2) AS TOTAL2
			,SUM(A.TOTAL3) AS TOTAL3
			,SUM(A.TOTAL4) AS TOTAL4
			,SUM(A.TOTAL5) AS TOTAL5
			,SUM(A.TOTAL6) AS TOTAL6
			,SUM(A.TOTAL7) AS TOTAL7
			,SUM(A.TOTAL8) AS TOTAL8
			,SUM(A.TOTAL9) AS TOTAL9
			,SUM(A.TOTAL10) AS TOTAL10
			,SUM(A.TOTAL11) AS TOTAL11
			,SUM(A.TOTAL12) AS TOTAL12
			,SUM(A.TOTAL13) AS TOTAL13
			,SUM(A.TOTAL14) AS TOTAL14
			,SUM(A.TOTAL15) AS TOTAL15
			,SUM(A.TOTAL16) AS TOTAL16
			,SUM(A.TOTAL17) AS TOTAL17
			,SUM(A.TOTAL18) AS TOTAL18
			,SUM(A.TOTAL19) AS TOTAL19
			,SUM(A.TOTAL20) AS TOTAL20
			,SUM(A.TOTAL21) AS TOTAL21
			,SUM(A.TOTAL22) AS TOTAL22
			,SUM(A.TOTAL23) AS TOTAL23
			,SUM(A.TOTAL24) AS TOTAL24
			,SUM(A.TOTAL25) AS TOTAL25
			,SUM(A.TOTAL26) AS TOTAL26
			,SUM(A.TOTAL27) AS TOTAL27
			,SUM(A.TOTAL28) AS TOTAL28
			,SUM(A.TOTAL29) AS TOTAL29
			,SUM(A.TOTAL30) AS TOTAL30
			,SUM(A.TOTAL31) AS TOTAL31
			,SUM(A.TOTAL32) AS TOTAL32
			,SUM(A.TOTAL33) AS TOTAL33
			,SUM(A.TOTAL34) AS TOTAL34
			,SUM(A.TOTAL35) AS TOTAL35
			,SUM(A.TOTAL36) AS TOTAL36
			,SUM(A.TOTAL37) AS TOTAL37
			,SUM(A.TOTAL38) AS TOTAL38
			,SUM(A.TOTAL39) AS TOTAL39
			,SUM(A.TOTAL40) AS TOTAL40
			,SUM(A.TOTAL41) AS TOTAL41
			,SUM(A.TOTAL42) AS TOTAL42
			,SUM(A.TOTAL43) AS TOTAL43
			,SUM(A.TOTAL44) AS TOTAL44
		FROM(
			SELECT
				 Z.*
				,Z.CASE1 + Z.CASE5 AS TOTAL1
				,Z.CASE2 + Z.CASE6 AS TOTAL2
				,Z.CASE3 + Z.CASE7 AS TOTAL3
				,Z.CASE4 + Z.CASE8 AS TOTAL4
				,Z.CASE9 + Z.CASE13 AS TOTAL5
				,Z.CASE10 + Z.CASE14 AS TOTAL6
				,Z.CASE11 + Z.CASE15 AS TOTAL7
				,Z.CASE12 + Z.CASE16 AS TOTAL8
				,Z.CASE17 + Z.CASE21 AS TOTAL9
				,Z.CASE18 + Z.CASE22 AS TOTAL10
				,Z.CASE19 + Z.CASE23 AS TOTAL11
				,Z.CASE20 + Z.CASE24 AS TOTAL12
				,Z.CASE25 + Z.CASE29 AS TOTAL13
				,Z.CASE26 + Z.CASE30 AS TOTAL14
				,Z.CASE27 + Z.CASE31 AS TOTAL15
				,Z.CASE28 + Z.CASE32 AS TOTAL16
				,Z.CASE33 + Z.CASE37 AS TOTAL17
				,Z.CASE34 + Z.CASE38 AS TOTAL18
				,Z.CASE35 + Z.CASE39 AS TOTAL19
				,Z.CASE36 + Z.CASE40 AS TOTAL20
				,Z.CASE41 + Z.CASE45 AS TOTAL21
				,Z.CASE42 + Z.CASE46 AS TOTAL22
				,Z.CASE43 + Z.CASE47 AS TOTAL23
				,Z.CASE44 + Z.CASE48 AS TOTAL24
				,Z.CASE49 + Z.CASE53 AS TOTAL25
				,Z.CASE50 + Z.CASE54 AS TOTAL26
				,Z.CASE51 + Z.CASE55 AS TOTAL27
				,Z.CASE52 + Z.CASE56 AS TOTAL28
				,Z.CASE57 + Z.CASE61 AS TOTAL29
				,Z.CASE58 + Z.CASE62 AS TOTAL30
				,Z.CASE59 + Z.CASE63 AS TOTAL31
				,Z.CASE60 + Z.CASE64 AS TOTAL32
				,Z.CASE65 + Z.CASE69 AS TOTAL33
				,Z.CASE66 + Z.CASE70 AS TOTAL34
				,Z.CASE67 + Z.CASE71 AS TOTAL35
				,Z.CASE68 + Z.CASE72 AS TOTAL36
				,Z.CASE73 + Z.CASE77 AS TOTAL37
				,Z.CASE74 + Z.CASE78 AS TOTAL38
				,Z.CASE75 + Z.CASE79 AS TOTAL39
				,Z.CASE76 + Z.CASE80 AS TOTAL40
				,Z.CASE81 + Z.CASE85 AS TOTAL41
				,Z.CASE82 + Z.CASE86 AS TOTAL42
				,Z.CASE83 + Z.CASE87 AS TOTAL43
				,Z.CASE84 + Z.CASE88 AS TOTAL44
			FROM (
				SELECT 
					 COM_CODE
					,FN_COM_CODE(COM_CODE) AS COM_CODE_NM
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE1
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE2
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE3
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE4
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE5
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE6
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE7
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '301' THEN 1 ELSE 0 END) CASE8
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE9
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE10
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE11
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE12
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE13
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE14
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE15
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '302' THEN 1 ELSE 0 END) CASE16
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE17
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE18
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE19
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE20
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE21
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE22
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE23
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '303' THEN 1 ELSE 0 END) CASE24
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE25
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE26
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE27
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE28
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE29
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE30
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE31
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '304' THEN 1 ELSE 0 END) CASE32
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE33
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE34
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE35
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE36
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE37
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE38
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE39
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '305' THEN 1 ELSE 0 END) CASE40
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE41
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE42
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE43
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE44
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE45
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE46
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE47
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '306' THEN 1 ELSE 0 END) CASE48
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE49
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE50
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE51
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE52
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE53
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE54
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE55
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '307' THEN 1 ELSE 0 END) CASE56
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE57
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE58
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE59
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE60
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE61
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE62
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE63
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '308' THEN 1 ELSE 0 END) CASE64
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE65
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE66
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE67
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE68
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE69
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE70
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE71
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '309' THEN 1 ELSE 0 END) CASE72
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE73
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE74
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE75
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE76
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE77
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE78
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE79
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '310' THEN 1 ELSE 0 END) CASE80
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE81
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE82
					,SUM(CASE WHEN PL_PRODUCT = '01' AND PL_CLASS = '2' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE83
					,SUM(CASE WHEN PL_PRODUCT = '03' AND PL_CLASS = '2' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE84
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'N' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE85
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '1' AND CORP_USER_YN = 'Y' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE86
					,SUM(CASE WHEN PL_PRODUCT = '05' AND PL_CLASS = '2' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE87
					,SUM(CASE WHEN PL_PRODUCT = '06' AND PL_CLASS = '2' AND TLV.VIO_NUM = '311' THEN 1 ELSE 0 END) CASE88
				FROM TB_LC_MAS01 TLM
				JOIN TB_LC_VIOLATION TLV 
				ON TLM.MASTER_SEQ = TLV.MASTER_SEQ 
				WHERE TLM.USE_YN = 'Y'
				AND TLV.VIO_NUM IS NOT NULL
				AND TLV.VIO_NUM != ''
				AND TLM.COM_CODE IS NOT NULL
				GROUP BY TLM.COM_CODE
			)Z
		)A
		GROUP BY ROLLUP(A.COM_CODE_NM)
		ORDER BY A.COM_CODE_NM ASC
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	

</mapper> 