<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loanscrefia.common.member.repository.MemberRepository">
    <select id="save" parameterType="member" resultType="member">
	    <!-- MemberRepository.save -->
		INSERT INTO TBL_MEMBER
		(
			 LOGIN_ID						/*로그인ID*/
			,PASSWORD						/*비밀번호*/
			,COMP_ID						/*회원사ID*/
			,MEM_NM							/*담당자명*/
			,EMAIL							/*이메일*/
			,MOBILE_NO						/*전화번호*/
			,DEPT_NM						/*부서명*/
			,POSITION_NM					/*직위명*/
			,JOIN_DT						/*가입일*/
			,FILE_ID						/*첨부파일ID*/
		)
		VALUES
		(
			 #{userId}                     	/*로그인ID*/ 
			,#{password}                    /*비밀번호*/  
			,#{companyCd}                   /*회원사ID*/ 
			,#{memNm}                       /*담당자명*/  
			,#{email}                       /*이메일*/   
			,#{mobileNo}                    /*전화번호*/  
			,#{deptNm}                      /*부서명*/   
			,#{positionNm}                  /*직위명*/   
			,TO_CHAR(NOW(), 'YYYYMMDD')		/*가입일*/   
			,#{fileId}						/*첨부파일ID*/
		)	
	</select>
	
    <select id="findByEmail" parameterType="member" resultType="member">
	    <!-- MemberRepository.findByEmail -->
	    select *
	    from tbl_members
	    where email = #{findByEmail}
    </select>
   
    
    <select id="findRoles" parameterType="member" resultType="memberRole">
	    <!-- MemberRoleRepository.findRoles -->
	    select *
	    from tbl_member_role
	    where member_no = #{memberNo}
    </select>
    
    <update id="loginFailCnt" parameterType="string" >
    	UPDATE tbl_members
    	SET fail_cnt = fail_cnt+1
    	WHERE email = #{email}
    </update>
    
    
    <select id="getMember" parameterType="member" resultType="member">
	    select *
	    from tbl_members
	    where member_no = #{memberNo}
    </select>
    
</mapper> 