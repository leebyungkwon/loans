<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loanscrefia.common.member.repository.MemberRepository">
    <select id="save" parameterType="member" resultType="long">
	    <!-- MemberRepository.save -->
	    insert into tbl_members
		(email, member_nm, password)
		values(#{email}, #{memberNm}, #{password})
		RETURNING member_no
	</select>
    
    <select id="findByEmail" parameterType="member" resultType="member">
	    <!-- MemberRepository.findByEmail -->
	    select *
	    from tbl_members
	    where email = #{findByEmail}
    </select>
   
    
    <select id="findRoles" parameterType="member" resultType="memberRole">
	    <!-- MemberRoleRepository.findRoles -->
	    select *
	    from tbl_member_role
	    where member_no = #{memberNo}
    </select>
    
    <update id="loginFailCnt" parameterType="string" >
    	UPDATE tbl_members
    	SET fail_cnt = fail_cnt+1
    	WHERE email = #{email}
    </update>
    
    
    <select id="getMember" parameterType="member" resultType="member">
	    select *
	    from tbl_members
	    where member_no = #{memberNo}
    </select>
    
</mapper> 