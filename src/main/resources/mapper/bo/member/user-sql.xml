<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.loanscrefia.member.user.repository.UserRepository">
   
   	<!-- 모집인 등록 > 리스트 -->
   	<select id="selectUserRegList" parameterType="user" resultType="user">
   		SELECT 
	    	<include refid="common.totalPages"/>
	    	 TLM.MASTER_SEQ
			,TLM.COM_CODE
			,TLM.MEMBER_SEQ
			,TLM.PL_CLASS
			<!-- ,FN_CD_DTL('A0001',TLM.PL_CLASS) AS PL_CLASS_NM -->
			,TLM.CAREER_TYP
			<!-- ,FN_CD_DTL('A0001',TLM.CAREER_TYP) AS CAREER_TYP_NM -->
			,TLM.PL_PRODUCT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_PRODUCT) AS PL_PRODUCT_NM -->
			,TLM.PL_REG_STAT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_REG_STAT) AS PL_REG_STAT_NM -->
			,TLM.PL_STAT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_STAT) AS PL_STAT_NM -->
			,TLM.PL_REGIST_NO
			,TLM.PL_M_NAME
			,TLM.PL_M_Z_ID
			,TLM.PL_M_Z_ID_EDU
			,TLM.PL_CELLPHONE
			,TLM.ADDR
			,TLM.ADDR_DETAIL
			,TLM.PL_EDU_NO
			,TLM.CAREER_START_DATE
			,TLM.CAREER_END_DATE
			,TLM.ENTRUST_DATE
			,TLM.COM_CONT_DATE
			,TLM.PL_MERCHANT_NAME
			,TLM.PL_CEO_NAME
			,TLM.PL_MERCHANT_NO
			,TLM.PL_BUSINESS_NO
			,TLM.COMP_PHONE_NO
			,TLM.CORP_FOUND_DATE
			,TLM.CAPITAL
			,TLM.PL_PAY_STAT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_PAY_STAT) AS PL_PAY_STAT_NM -->
			,TLM.COM_REG_DATE
			,TLM.CRE_APP_DATE
			,TLM.CRE_LICENSE_DATE
			,TLM.PAY_DATE
			,TLM.SEND_MSG
			,TLM.PL_HIST_CD
			,TLM.COM_HAEJI_DATE
			,TLM.CRE_HAEJI_DATE
			,TLM.FILE_SEQ
			,TLM.REG_TIMESTAMP
			,TLM.UPD_SEQ
			,TLM.UPD_TIMESTAMP
	    FROM TB_LC_MAS01 TLM
		<where>
	    	<if test="plStat != null and plStat != ''">
				AND TLM.PL_STAT = #{plStat}
			</if>
	    </where>
	    <include refid="common.pageBottom"/>
   	</select>
   
   	<!-- 모집인 등록 > 개인 등록 -->
   	<insert id="insertUserRegIndvInfoByExcel" parameterType="user">
   		INSERT INTO TB_LC_MAS01
   		(
			 COM_CODE
			,MEMBER_SEQ
			,PL_REG_STAT
			,PL_STAT
			,PL_CLASS
			,CAREER_TYP
			,PL_M_NAME
			,PL_M_Z_ID
			,PL_CELLPHONE
			,ADDR
			,PL_PRODUCT
			,PL_MERCHANT_NAME
			,PL_MERCHANT_NO
			,PL_EDU_NO
			,CAREER_START_DATE
			,CAREER_END_DATE
			,COM_CONT_DATE
			,ENTRUST_DATE
			,REG_TIMESTAMP
   		)
   		VALUES
   		<foreach collection="excelParam" item="item" separator=",">
   		(
   			 #{comCode}
   			,#{memberSeq}
   			,'1'				-- 1.등록,2.정상해지,3.불법해지
   			,'9'				-- 승인미요청
   			,#{plClass} 		-- 개인,법인
   			,#{item.A} 			-- 신규,경력
   			,#{item.B} 			-- 이름
   			,#{item.C}			-- 주민등록번호
   			,#{item.D}			-- 휴대폰번호
   			,#{item.E}			-- 주소
   			,#{item.F}			-- 금융상품유형
   			,#{item.G}			-- 법인명
   			,#{item.H}			-- 법인등록번호
   			,#{item.I}			-- 교육이수번호/인증서번호
   			,#{item.J}			-- 경력시작일
   			,#{item.K}			-- 경력종료일
   			,#{item.L}			-- 계약일자
   			,#{item.M}			-- 위탁예정기간
   			,NOW()
   		)
   		</foreach>
   	</insert>
   	
   	<!-- 모집인 등록 > 법인 등록 -->
   	<insert id="insertUserRegCorpInfoByExcel" parameterType="user">
   		INSERT INTO TB_LC_MAS01
   		(
			 COM_CODE
			,MEMBER_SEQ
			,PL_REG_STAT
			,PL_STAT
			,PL_CLASS
			,PL_MERCHANT_NAME
			,PL_CEO_NAME
			,PL_MERCHANT_NO
			,CORP_FOUND_DATE
			,ADDR
			,CAPITAL
			,PL_PRODUCT
			,COM_CONT_DATE
			,ENTRUST_DATE
			,REG_TIMESTAMP
   		)
   		VALUES
   		<foreach collection="excelParam" item="item" separator=",">
   		(
   			 #{comCode}
   			,#{memberSeq}
   			,'1'				-- 1.등록,2.정상해지,3.불법해지
   			,'9'				-- 승인미요청
   			,#{plClass} 		-- 개인,법인
   			,#{item.A}			-- 상호
			,#{item.B}			-- 대표이사
			,#{item.C}			-- 법인등록번호
			,#{item.D}			-- 설립년월일
			,#{item.E}			-- 본점소재지
			,#{item.F}			-- 자본금
			,#{item.G}			-- 금융상품유형
			,#{item.H}			-- 계약일자
			,#{item.I}			-- 위탁예정기간
   			,NOW()
   		)
   		</foreach>
   	</insert>
   
   	<!-- 모집인 등록 > 승인요청 -->
   	<update id="updatePlRegStat" parameterType="user">
   		UPDATE TB_LC_MAS01
   		SET
   			PL_STAT = '8'
   		<where>
   			AND MASTER_SEQ 	= #{masterSeq}
   			AND UPD_SEQ 	= #{updSeq}
   		</where>
   	</update>
    
   	<!-- 모집인 등록 > 상세 -->
   	<select id="getUserRegDetail" parameterType="user" resultType="user">
   		SELECT 
	    	 TLM.MASTER_SEQ
			,TLM.COM_CODE
			<!-- ,(SELECT TLC.COM_NAME FROM TB_LC_COMPANY TLC WHERE TLC.COM_CODE = TLM.COM_CODE) AS COM_CODE_NM -->
			,TLM.MEMBER_SEQ
			<!-- ,(SELECT MEMBER_NM FROM TB) AS MEMBER_NM -->
			,TLM.PL_CLASS
			<!-- ,FN_CD_DTL('A0001',TLM.PL_CLASS) AS PL_CLASS_NM -->
			,TLM.CAREER_TYP
			<!-- ,FN_CD_DTL('A0001',TLM.CAREER_TYP) AS CAREER_TYP_NM -->
			,TLM.PL_PRODUCT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_PRODUCT) AS PL_PRODUCT_NM -->
			,TLM.PL_REG_STAT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_REG_STAT) AS PL_REG_STAT_NM -->
			,TLM.PL_STAT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_STAT) AS PL_STAT_NM -->
			,TLM.PL_REGIST_NO
			,TLM.PL_M_NAME
			,TLM.PL_M_Z_ID
			,TLM.PL_CELLPHONE
			,TLM.ADDR
			<!-- ,FN_CD_DTL('A0001',TLM.ADDR) AS ADDR_NM -->
			,TLM.ADDR_DETAIL
			,TLM.PL_EDU_NO
			,TLM.CAREER_START_DATE
			,TLM.CAREER_END_DATE
			,TLM.ENTRUST_DATE
			,TLM.COM_CONT_DATE
			,TLM.PL_MERCHANT_NAME
			,TLM.PL_CEO_NAME
			,TLM.PL_MERCHANT_NO
			,TLM.PL_BUSINESS_NO
			,TLM.COMP_PHONE_NO
			,TLM.CORP_FOUND_DATE
			,TLM.CAPITAL
			,TLM.PL_PAY_STAT
			<!-- ,FN_CD_DTL('A0001',TLM.PL_PAY_STAT) AS PL_PAY_STAT_NM -->
			,TLM.COM_REG_DATE
			,TLM.CRE_APP_DATE
			,TLM.CRE_LICENSE_DATE
			,TLM.PAY_DATE
			,TLM.SEND_MSG
			,TLM.PL_HIST_CD
			,TLM.COM_HAEJI_DATE
			,TLM.CRE_HAEJI_DATE
			,TLM.FILE_SEQ
			,TLM.REG_TIMESTAMP
			,TLM.UPD_SEQ
			,TLM.UPD_TIMESTAMP
	    FROM TB_LC_MAS01 TLM
	    <where>
	    	AND TLM.MASTER_SEQ = #{masterSeq}
	    </where>
   	</select>
   
	<!-- 모집인 등록 > 수정 -->
   	<update id="updateUserRegInfo" parameterType="user">
   		UPDATE TB_LC_MAS01
   		SET
   			<if test="plMName != null and plMName != ''">
   			 PL_M_NAME 			= #{plMName}
   			</if>
   			<if test="plMZId != null and plMZId != ''">
   			,PL_M_Z_ID 			= #{plMZId}
   			</if>
   			<if test="plCellphone != null and plCellphone != ''">
   			,PL_CELLPHONE 		= #{plCellphone}
   			</if>
   			<if test="addr != null and addr != ''">
   			,ADDR 				= #{addr}
   			</if>
   			<if test="addrDetail != null and addrDetail != ''">
   			,ADDR_DETAIL		= #{addrDetail}
   			</if>
   			<if test="plEduNo != null and plEduNo != ''">
   			,PL_EDU_NO 			= #{plEduNo}
   			</if>
   			<if test="careerStartDate != null and careerStartDate != ''">
   			,CAREER_START_DATE 	= #{careerStartDate}
   			</if>
   			<if test="careerEndDate != null and careerEndDate != ''">
   			,CAREER_END_DATE 	= #{careerEndDate}
   			</if>
   			<if test="comContDate != null and comContDate != ''">
   			,COM_CONT_DATE 		= #{comContDate}
   			</if>
   			<if test="entrustDate != null and entrustDate != ''">
   			,ENTRUST_DATE 		= #{entrustDate}
   			</if>
   			,FILE_SEQ 			= #{fileSeq}
   		<where>
	    	AND MASTER_SEQ 		= #{masterSeq}
	    </where>
   	</update>
   	
</mapper> 